# RssEngineers

RSS сервис для бегущей строки авиаконструкторов с реакцией на удаление пользователей.

## Описание функциональности

Приложение работает как "бегущая строка", которая реагирует на удаление пользователей:

1. **Сбор в пул (1 минута):** Когда пользователь удаляется, он добавляется в пул. Запускается таймер на 1 минуту для сбора других пользователей.
2. **Запуск бегущей строки (10 минут):** Через минуту все пользователи из пула начинают отображаться в бегущей строке на 10 минут.
3. **Расширение времени:** Если во время работы бегущей строки удаляются новые пользователи, они сразу добавляются к отображаемым, и время работы продлевается на 1 минуту за каждого нового пользователя.
4. **Дефолтный текст:** Если в течение минуты никто не попал в пул, или время бегущей строки истекло, отображается текст "Известные авиаконструкторы КАИ".

## API Endpoints

### POST /events/user-deleted
Принимает события удаления пользователей.

**Тело запроса:**
```json
{
  "UserName": "Имя",
  "UserLastName": "Фамилия", 
  "UserEmail": "email@example.com",
  "idTab": "ID123"
}
```

### GET /rss/users
Возвращает RSS-ленту для бегущей строки.

### GET /
Информационная страница о сервисе.

## Установка и запуск

```bash
# Установка зависимостей
npm install

# Запуск в режиме разработки
npm run dev

# Запуск в production
npm start
```

Сервер запускается на порту 3202.

## Тестирование

### Пример сценария 1: Базовый функционал
```bash
# Отправляем первого пользователя
curl -X POST http://localhost:3202/events/user-deleted \
  -H "Content-Type: application/json" \
  -d '{"UserName": "Иван", "UserLastName": "Петров"}'

# В течение минуты отправляем еще пользователей
curl -X POST http://localhost:3202/events/user-deleted \
  -H "Content-Type: application/json" \
  -d '{"UserName": "Мария", "UserLastName": "Иванова"}'

# Проверяем RSS-ленту
curl http://localhost:3202/rss/users
```

### Пример сценария 2: Добавление во время работы
```bash
# Сначала запускаем бегущую строку (как в сценарии 1)
# Ждем 7 минут
# Добавляем нового пользователя - он сразу появится в строке
curl -X POST http://localhost:3202/events/user-deleted \
  -H "Content-Type: application/json" \
  -d '{"UserName": "Анна", "UserLastName": "Сидорова"}'
```

## Логика работы

- **userPool:** Массив для сбора пользователей в течение 1 минуты
- **activeMarqueeUsers:** Массив пользователей, отображаемых в бегущей строке
- **poolTimer:** Таймер на 1 минуту для сбора в пул
- **marqueeTimer:** Таймер на 10 минут (или продленный) для отображения бегущей строки
- **marqueeExpireAt:** Время окончания отображения бегущей строки
